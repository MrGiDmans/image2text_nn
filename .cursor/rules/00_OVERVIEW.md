# Проект Captioning Model — Архитектура и Принципы

## Цель
Создать модульную, расширяемую и переносимую модель captioning-системы.  
Код пишется в стиле ООП, всё разделено на уровни: данные → модель → обучение → инференс.

---

## Архитектура проекта
src/
├── models/
│ ├── encoder_cnn.py → Кодировщик изображения
│ ├── decoder_rnn.py → RNN/Transformer декодер
│ ├── caption_model.py → Обёртка над encoder+decoder
├── utils/
│ ├── vocabulary.py → Построение словаря
│ ├── transforms.py → Аугментации и предобработка
│ ├── dataSet.py → Dataset
│ ├── dataLoader.py → DataLoader + логи
│ ├── collate_fn.py → Функция склейки padded последовательностей
│ ├── metrics.py → BLEU, CIDEr, METEOR
│ ├── early_stopping.py → Ранняя остановка
│ └── logger.py → Логирование
├── train.py → Цикл обучения
├── test.py → Инференс
└── README.md

---

## Принципы ООП
1. **Единая ответственность (SRP)**  
   Каждый файл отвечает за один аспект.

2. **Инкапсуляция**  
   Модель скрывает детали реализации encoder/decoder.

3. **Полиморфизм**  
   Легко заменить CNN-энкодер или декодер (LSTM → Transformer).

4. **Композиция > Наследование**  
   `CaptionModel` содержит `encoder` + `decoder`, а не наследует.

---

## Возможность портирования в R
- модель и параметры отделены от данных;  
- архитектура не привязана к Python-экосистеме;  
- можно экспортировать веса и воспроизводить слой-за-слоем.

Это позволяет перенести модель в R с помощью torch for R или reticulate.

